"use strict";(self["webpackChunkHouseHub"]=self["webpackChunkHouseHub"]||[]).push([[289],{7289:function(e,t,i){i.r(t),i.d(t,{default:function(){return Oe}});var s=i(6768),a=i(4232);const o={class:"card"},l={class:"m-0"},r={class:"m-0"},n={class:"m-0"},d={class:"m-0"},m={class:"m-0"},c={class:"m-0"};function u(e,t,i,u,p,h){const y=(0,s.g2)("Select"),b=(0,s.g2)("Button"),f=(0,s.g2)("Tab"),v=(0,s.g2)("TabList"),g=(0,s.g2)("Lotes"),C=(0,s.g2)("TabPanel"),T=(0,s.g2)("TipoLotes"),w=(0,s.g2)("TipoCuotas"),V=(0,s.g2)("ConceptosCA"),k=(0,s.g2)("TipoEgresos"),A=(0,s.g2)("Users"),x=(0,s.g2)("TabPanels"),F=(0,s.g2)("Tabs"),I=(0,s.gN)("tooltip");return(0,s.uX)(),(0,s.CE)("div",o,[t[2]||(t[2]=(0,s.Lk)("div",{class:"card"},[(0,s.Lk)("h2",{style:{display:"flex","align-items":"center",gap:"10px"}},[(0,s.Lk)("i",{class:"pi pi-cog",style:{"font-size":"2rem"}}),(0,s.eW)(" Configuracion")])],-1)),(0,s.Lk)("div",null,[t[1]||(t[1]=(0,s.Lk)("b",{style:{color:"var(--p-tabs-tab-active-color)"}},"Seleccione el condominio: ",-1)),(0,s.bF)(y,{modelValue:p.selectedItem,"onUpdate:modelValue":t[0]||(t[0]=e=>p.selectedItem=e),options:p.condominiosList,optionLabel:"name",onChange:h.refreshTable,style:{width:"250px"},size:"small"},null,8,["modelValue","options","onChange"]),(0,s.bo)((0,s.bF)(b,{icon:"pi pi-sync",variant:"text",onClick:h.refreshTable,style:{"margin-right":"20px"}},null,8,["onClick"]),[[I,"Actualizar lista",void 0,{top:!0}]])]),(0,s.Lk)("div",null,[(0,s.bF)(F,null,{default:(0,s.k6)(()=>[(0,s.bF)(v,null,{default:(0,s.k6)(()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(p.items,e=>((0,s.uX)(),(0,s.Wv)(f,{key:e.id,value:e.id},{default:(0,s.k6)(()=>[(0,s.Lk)("div",null,[(0,s.Lk)("i",{class:(0,a.C4)(e.icon),style:{"margin-right":"10px"}},null,2),(0,s.eW)(" "+(0,a.v_)(e.label),1)])]),_:2},1032,["value"]))),128))]),_:1}),(0,s.bF)(x,null,{default:(0,s.k6)(()=>[(0,s.bF)(C,{value:"0"},{default:(0,s.k6)(()=>[(0,s.Lk)("p",l,[(0,s.bF)(g,{selectedCondominio:p.selectedItem},null,8,["selectedCondominio"])])]),_:1}),(0,s.bF)(C,{value:"1"},{default:(0,s.k6)(()=>[(0,s.Lk)("p",r,[(0,s.bF)(T,{selectedCondominio:p.selectedItem},null,8,["selectedCondominio"])])]),_:1}),(0,s.bF)(C,{value:"2"},{default:(0,s.k6)(()=>[(0,s.Lk)("p",n,[(0,s.bF)(w,{selectedCondominio:p.selectedItem},null,8,["selectedCondominio"])])]),_:1}),(0,s.bF)(C,{value:"3"},{default:(0,s.k6)(()=>[(0,s.Lk)("p",d,[(0,s.bF)(V,{selectedCondominio:p.selectedItem},null,8,["selectedCondominio"])])]),_:1}),(0,s.bF)(C,{value:"4"},{default:(0,s.k6)(()=>[(0,s.Lk)("p",m,[(0,s.bF)(k,{selectedCondominio:p.selectedItem},null,8,["selectedCondominio"])])]),_:1}),(0,s.bF)(C,{value:"5"},{default:(0,s.k6)(()=>[(0,s.Lk)("p",c,[(0,s.bF)(A,{selectedCondominio:p.selectedItem},null,8,["selectedCondominio"])])]),_:1})]),_:1})]),_:1})])])}var p=i(9765),h=i(7317),y=i(8188),b=i(5274),f=i(514),v=i(3441),g=i(8364),C=i(9018),T=i(542),w=i(5130);const V={style:{width:"90%"}},k={class:"flex-row gap-3"},A={class:"form"},x={class:"flex flex-col gap-1"},F={class:"flex flex-col gap-1"},I={class:"flex-row gap-3"},L={class:"formButtons"};function _(e,t,i,o,l,r){const n=(0,s.g2)("Toast"),d=(0,s.g2)("ConfirmPopup"),m=(0,s.g2)("TableBar"),c=(0,s.g2)("Column"),u=(0,s.g2)("InputText"),p=(0,s.g2)("Message"),h=(0,s.g2)("Select"),y=(0,s.g2)("DataTable"),b=(0,s.g2)("Button"),f=(0,s.g2)("Form"),v=(0,s.g2)("Dialog");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bF)(n),(0,s.bF)(d),(0,s.Lk)("div",V,[(0,s.bF)(m,{showIcons:[1,0,1,1,1],onAddItem:r.addItem,onDeleteItem:r.deleteItem,onRefreshTable:r.refreshTable,onExportExcel:r.exportExcel},null,8,["onAddItem","onDeleteItem","onRefreshTable","onExportExcel"]),(0,s.bF)(y,{selection:l.selectedItems,"onUpdate:selection":t[4]||(t[4]=e=>l.selectedItems=e),value:l.items,sortField:"id",stripedRows:"",size:"small",paginator:"",rows:10,selectionMode:"multiple",metaKeySelection:l.metaKey,dataKey:"id",editMode:"cell",onCellEditComplete:r.onCellEditComplete,pt:{table:{style:"min-width: 50rem"},column:{bodycell:({state:e})=>({class:[{"!py-0":e["d_editing"]}]})}}},{empty:(0,s.k6)(()=>t[9]||(t[9]=[(0,s.eW)(" No existen datos para esta tabla. ",-1)])),loading:(0,s.k6)(()=>t[10]||(t[10]=[(0,s.eW)(" Cargando informacion.... ",-1)])),default:(0,s.k6)(()=>[(0,s.bF)(c,{selectionMode:"multiple",style:{width:"1%"}}),(0,s.bF)(c,{field:"name",header:"Nombre",style:{width:"30%"}},{body:(0,s.k6)(({data:e})=>[(0,s.eW)((0,a.v_)(e.name),1)]),editor:(0,s.k6)(({data:e,field:i})=>[(0,s.bF)(u,{modelValue:e.name,"onUpdate:modelValue":t=>e.name=t,autofocus:"",fluid:"",size:"small",onKeydown:t[0]||(t[0]=(0,w.jR)(e=>e.target.blur(),["enter"])),class:(0,a.C4)({"p-invalid":!r.isNameValid(e,i)})},null,8,["modelValue","onUpdate:modelValue","class"]),r.isNameValid(e,i)?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(p,{key:0,severity:"error",size:"small",variant:"simple"},{default:(0,s.k6)(()=>[(0,s.eW)((0,a.v_)(l.errors.name),1)]),_:1}))]),_:1}),(0,s.bF)(c,{field:"description",header:"Descripcion",style:{width:"30%"}},{body:(0,s.k6)(({data:e})=>[(0,s.eW)((0,a.v_)(e.description),1)]),editor:(0,s.k6)(({data:e,field:i})=>[(0,s.bF)(u,{modelValue:e.description,"onUpdate:modelValue":t=>e.description=t,autofocus:"",fluid:"",size:"small",onKeydown:t[1]||(t[1]=(0,w.jR)(e=>e.target.blur(),["enter"])),class:(0,a.C4)({"p-invalid":!r.isDescriptionValid(e,i)})},null,8,["modelValue","onUpdate:modelValue","class"]),r.isDescriptionValid(e,i)?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(p,{key:0,severity:"error",size:"small",variant:"simple"},{default:(0,s.k6)(()=>[(0,s.eW)((0,a.v_)(l.errors.description),1)]),_:1}))]),_:1}),(0,s.bF)(c,{field:"lotetypeId",header:"Tipo de Lote",style:{width:"20%"}},{body:(0,s.k6)(({data:e})=>[(0,s.eW)((0,a.v_)(e.lotetypeName),1)]),editor:(0,s.k6)(({data:e})=>[(0,s.bF)(h,{name:"lotetypeId",options:l.itemsLoteTypes,modelValue:l.selectedLoteType,"onUpdate:modelValue":t[2]||(t[2]=e=>l.selectedLoteType=e),optionLabel:"name",placeholder:"Tipo de lote",fluid:"",style:{"margin-bottom":"10px","margin-top":"10px"},size:"small"},null,8,["options","modelValue"])]),_:1}),(0,s.bF)(c,{field:"cuotatypeId",header:"Cuota asignada",style:{width:"30%"}},{body:(0,s.k6)(({data:e})=>[(0,s.eW)((0,a.v_)(e.cuotatypeName),1)]),editor:(0,s.k6)(({data:e})=>[(0,s.bF)(h,{name:"cuotatypeId",options:l.itemsCuotaTypes,optionLabel:"name",modelValue:l.selectedCuotaType,"onUpdate:modelValue":t[3]||(t[3]=e=>l.selectedCuotaType=e),placeholder:"Cuota asignada",fluid:"",style:{"margin-bottom":"10px","margin-top":"20px"},size:"small"},{option:(0,s.k6)(e=>[(0,s.Lk)("div",k,[(0,s.Lk)("div",null,(0,a.v_)(e.option.name),1),(0,s.Lk)("div",null,"$ "+(0,a.v_)(e.option.amount),1)])]),_:1},8,["options","modelValue"])]),_:1})]),_:1},8,["selection","value","metaKeySelection","onCellEditComplete","pt"])]),(0,s.bF)(v,{visible:l.showAdd,"onUpdate:visible":t[8]||(t[8]=e=>l.showAdd=e),modal:"",header:l.titulo,style:{width:"25rem"}},{default:(0,s.k6)(()=>[(0,s.Lk)("div",A,[(0,s.bF)(f,{initialValues:l.initialValues,resolver:r.resolver,validateOnValueUpdate:!1,validateOnBlur:!1,onSubmit:r.onFormSubmit,class:"flex flex-col gap-4 w-full sm:w-56"},{default:(0,s.k6)(e=>[(0,s.Lk)("div",x,[(0,s.bF)(u,{name:"name",type:"text",placeholder:"Nombre",fluid:"",size:"small"}),e.name?.invalid?((0,s.uX)(),(0,s.Wv)(p,{key:0,severity:"error",size:"small",variant:"simple"},{default:(0,s.k6)(()=>[(0,s.eW)((0,a.v_)(e.name.error.message),1)]),_:2},1024)):(0,s.Q3)("",!0)]),(0,s.Lk)("div",F,[(0,s.bF)(u,{name:"description",type:"text",placeholder:"Descripcion",fluid:"",size:"small"}),e.description?.invalid?((0,s.uX)(),(0,s.Wv)(p,{key:0,severity:"error",size:"small",variant:"simple"},{default:(0,s.k6)(()=>[(0,s.eW)((0,a.v_)(e.description.error.message),1)]),_:2},1024)):(0,s.Q3)("",!0)]),(0,s.bF)(h,{name:"lotetypeId",options:l.itemsLoteTypes,optionLabel:"name",placeholder:"Tipo de lote",fluid:"",style:{"margin-bottom":"10px","margin-top":"10px"},modelValue:l.selectedLoteType,"onUpdate:modelValue":t[5]||(t[5]=e=>l.selectedLoteType=e),size:"small"},null,8,["options","modelValue"]),e.lotetypeId?.invalid?((0,s.uX)(),(0,s.Wv)(p,{key:0,severity:"error",size:"small",variant:"simple"},{default:(0,s.k6)(()=>[(0,s.eW)((0,a.v_)(e.lotetypeId.error.message),1)]),_:2},1024)):(0,s.Q3)("",!0),(0,s.bF)(h,{name:"cuotatypeId",options:l.itemsCuotaTypes,optionLabel:"name",placeholder:"Cuota asignada",fluid:"",style:{"margin-bottom":"10px","margin-top":"20px"},modelValue:l.selectedCuotaType,"onUpdate:modelValue":t[6]||(t[6]=e=>l.selectedCuotaType=e),size:"small"},{option:(0,s.k6)(e=>[(0,s.Lk)("div",I,[(0,s.Lk)("div",null,(0,a.v_)(e.option.name),1),(0,s.Lk)("div",null,"$ "+(0,a.v_)(e.option.amount),1)])]),_:1},8,["options","modelValue"]),e.cuotatypeId?.invalid?((0,s.uX)(),(0,s.Wv)(p,{key:1,severity:"error",size:"small",variant:"simple"},{default:(0,s.k6)(()=>[(0,s.eW)((0,a.v_)(e.cuotatypeId.error.message),1)]),_:2},1024)):(0,s.Q3)("",!0),(0,s.Lk)("div",L,[(0,s.bF)(b,{type:"button",label:"Cancelar",severity:"secondary",onClick:t[7]||(t[7]=e=>l.showAdd=!1),style:{"margin-top":"20px"}}),(0,s.bF)(b,{type:"submit",label:"Guardar",style:{"margin-left":"20px"}})])]),_:1},8,["initialValues","resolver","onSubmit"])])]),_:1},8,["visible","header"])],64)}i(8111),i(2489),i(116),i(1701);var E=i(144),W=i(1677),K=i(3691),R=i(373),D=i(6697),S=i(6498),U=i(6988),z=i(3076),B=i(3053),N=i(569),q=i(3830),M=i(211),X=i(3230),j=i(788),P={props:{selectedCondominio:{type:Object,default:null}},components:{DataTable:K.A,Column:R.A,TableBar:W.A,Dialog:D.A,InputText:S.A,Button:C.A,Form:N.A,Select:T.A,Message:U.A,ConfirmPopup:z.A,Toast:B.A},data(){return{titulo:(0,E.KR)(""),confirm:(0,M.S)(),toast:(0,q.d)(),selectedItems:(0,E.KR)([]),selectedCuotaType:(0,E.KR)(),selectedLoteType:(0,E.KR)(),metaKey:(0,E.KR)(!0),items:(0,E.KR)([]),itemsLoteTypes:(0,E.KR)([]),itemsCuotaTypes:(0,E.KR)([]),showAdd:(0,E.KR)(!1),newItem:(0,E.KR)(!1),initialValues:{id:0,name:"",description:"",lotetypeId:null,cuotatypeId:null,condominio:null,users:null},errors:{name:"",description:"",loteType:"",cuotaType:""}}},methods:{async getTiposLote(){try{this.selectedCondominio&&(this.itemsLoteTypes=(await h.A.getTiposLoteByCondominio(this.selectedCondominio.id)).data)}catch(e){console.error("Failed to fetch Tipos de Lotes:",e),this.toast.add({severity:"error",summary:"Error de conexion con el servidor.",life:3e3})}},async getTiposCuota(){try{this.selectedCondominio&&(this.itemsCuotaTypes=(await h.A.getTiposCuotaByCondominio(this.selectedCondominio.id)).data)}catch(e){console.error("Failed to fetch Tipos de Lotes:",e),this.toast.add({severity:"error",summary:"Error de conexion con el servidor.",life:3e3})}},async refreshTable(){try{this.selectedCondominio&&(this.items=(await h.A.getLotesByCondominio(this.selectedCondominio.id)).data)}catch(e){console.error("Failed to fetch Lotes:",e),this.toast.add({severity:"error",summary:"Error de conexion con el servidor.",life:3e3})}},async updateLote(){try{return(await h.A.updateLote(this.initialValues)).data}catch(e){console.error("Failed to update Lote:",e),this.toast.add({severity:"error",summary:"Error al actualizar el registro.",life:3e3})}},async createLote(){try{return(await h.A.createLote(this.initialValues)).data}catch(e){console.error("Failed to create Lote:",e),this.toast.add({severity:"error",summary:"Error al crear un nuevo registro.",life:3e3})}},async deleteLote(e){try{await h.A.deleteLote(e),this.toast.add({severity:"info",summary:"Registros borrados",life:3e3}),this.selectedItems=null,await this.refreshTable()}catch(t){console.error("Failed to delete Lote:",t),this.toast.add({severity:"error",summary:"No se puede borrar el dato, verifique que no tenga dependencias con otros datos.",life:3e3})}},addItem(){this.selectedCondominio?(this.titulo="Agregar nuevo lote",this.getTiposLote(),this.getTiposCuota(),this.initialValues.id=null,this.initialValues.name="",this.initialValues.description="",this.initialValues.lotetypeId=null,this.initialValues.cuotatypeId=null,this.initialValues.users=[],this.selectedCuotaType=null,this.selectedLoteType=null,this.showAdd=!0,this.newItem=!0):this.toast.add({severity:"error",summary:"Seleccione un condominio para agregar un lote.",life:3e3})},deleteItem(e){this.selectedItems&&0!==this.selectedItems.length?this.confirm.require({target:e.currentTarget,message:"Desea borrar el/los registros?",icon:"pi pi-info-circle",rejectProps:{label:"Cancelar",severity:"secondary",outlined:!0},acceptProps:{label:"Borrar",severity:"danger"},accept:()=>{for(const e of this.selectedItems)this.deleteLote(e.id),this.items=this.items.filter(t=>t.id!==e.id)},reject:()=>{}}):this.toast.add({severity:"error",summary:"Seleccione un elemento para borrar.",life:3e3})},resolver({values:e}){const t={};return e.name?e.name.length>40&&(t.name=[{message:"El nombre no puede tener mas de 40 caracteres."}]):t.name=[{message:"El nombre es requerido."}],e.description?e.description.length>60&&(t.description=[{message:"La descripcion no puede tener mas de 60 caracteres."}]):t.description=[{message:"La descripcion descripcion es requerida."}],e.lotetypeId||(t.lotetypeId=[{message:"El tipo de lote es requerido."}]),e.cuotatypeId||(t.cuotatypeId=[{message:"La cuota es requerida."}]),this.initialValues.name=e.name,this.initialValues.description=e.description,this.initialValues.lotetypeId=e.lotetypeId,this.initialValues.cuotatypeId=e.cuotatypeId,{errors:t}},async onFormSubmit({valid:e}){e&&(this.showAdd=!1,this.selectedItems=[],this.newItem&&(this.initialValues.condominio=this.selectedCondominio,this.initialValues=await this.createLote(),this.items=[...this.items,this.initialValues],await this.refreshTable(),this.toast.add({severity:"success",summary:"Lote actualizado correctamente.",life:3e3})))},async onCellEditComplete(e){let{data:t,field:i,newValue:s,originalValue:a}=e;s?("lotetypeId"==i&&this.selectedLoteType&&this.selectedLoteType.id?(t.lotetypeId=this.itemsLoteTypes.find(e=>e.id===this.selectedLoteType.id),t.cuotatypeId=this.itemsCuotaTypes.find(e=>e.id===t.cuotatypeId)):"cuotatypeId"==i&&this.selectedCuotaType&&this.selectedCuotaType.id?(t.cuotatypeId=this.itemsCuotaTypes.find(e=>e.id===this.selectedCuotaType.id),t.lotetypeId=this.itemsLoteTypes.find(e=>e.id===t.lotetypeId)):(t[i]=s,t.cuotatypeId=this.itemsCuotaTypes.find(e=>e.id===t.cuotatypeId),t.lotetypeId=this.itemsLoteTypes.find(e=>e.id===t.lotetypeId)),this.initialValues=t,this.initialValues.condominio=this.selectedCondominio,this.initialValues.users=null,await this.updateLote(),await this.refreshTable()):s=t[i]},isNameValid(e,t){return e[t]?!(e[t].length>40)||(this.errors.name="El nombre no puede tener mas de 40 caracteres.",!1):(this.errors.name="El nombre es un campo requerido.",!1)},isDescriptionValid(e,t){return e[t]?!(e[t].length>60)||(this.errors.description="La descripcion no puede tener mas de 60 caracteres.",!1):(this.errors.description="La descripcion es un campo requerido.",!1)},exportExcel(){if(0===this.items.length)this.toast.add({severity:"warn",summary:"No hay datos para exportar.",life:3e3});else{const e=this.items.map(e=>({Nombre:e.name,Descripcion:e.description,Tipo:e.lotetypeName,Cuota:e.cuotatypeName})),t=X.Wp.json_to_sheet(e),i=X.Wp.book_new();X.Wp.book_append_sheet(i,t,"lotes");const s=X.M9(i,{bookType:"xlsx",type:"array"}),a=new Blob([s],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});(0,j.saveAs)(a,"Listado de lotes.xlsx")}}},watch:{selectedCondominio(e,t){this.refreshTable(),this.selectedItems=null,this.getTiposLote(),this.getTiposCuota()}},mounted(){this.refreshTable(),this.getTiposLote(),this.getTiposCuota()}},Q=i(1241);const O=(0,Q.A)(P,[["render",_]]);var G=O;const H={style:{width:"90%"}},$={class:"form"},J={class:"flex flex-col gap-1"},Y={class:"flex flex-col gap-1"},Z={class:"formButtons"};function ee(e,t,i,o,l,r){const n=(0,s.g2)("Toast"),d=(0,s.g2)("ConfirmPopup"),m=(0,s.g2)("TableBar"),c=(0,s.g2)("Column"),u=(0,s.g2)("InputText"),p=(0,s.g2)("Message"),h=(0,s.g2)("DataTable"),y=(0,s.g2)("Button"),b=(0,s.g2)("Form"),f=(0,s.g2)("Dialog");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bF)(n),(0,s.bF)(d),(0,s.Lk)("div",H,[(0,s.bF)(m,{showIcons:[1,0,1,1,1],onAddItem:r.addItem,onDeleteItem:r.deleteItem,onRefreshTable:r.refreshTable,onExportExcel:r.exportExcel},null,8,["onAddItem","onDeleteItem","onRefreshTable","onExportExcel"]),(0,s.bF)(h,{selection:l.selectedItems,"onUpdate:selection":t[2]||(t[2]=e=>l.selectedItems=e),value:l.items,sortField:"id",stripedRows:"",size:"small",paginator:"",rows:10,selectionMode:"multiple",metaKeySelection:l.metaKey,dataKey:"id",editMode:"cell",onCellEditComplete:r.onCellEditComplete,pt:{table:{style:"min-width: 50rem"},column:{bodycell:({state:e})=>({class:[{"!py-0":e["d_editing"]}]})}}},{empty:(0,s.k6)(()=>t[5]||(t[5]=[(0,s.eW)(" No existen datos para esta tabla. ",-1)])),loading:(0,s.k6)(()=>t[6]||(t[6]=[(0,s.eW)(" Cargando informacion.... ",-1)])),default:(0,s.k6)(()=>[(0,s.bF)(c,{selectionMode:"multiple",style:{width:"2%"}}),(0,s.bF)(c,{field:"name",header:"Nombre",style:{width:"48%"}},{body:(0,s.k6)(({data:e})=>[(0,s.eW)((0,a.v_)(e.name),1)]),editor:(0,s.k6)(({data:e,field:i})=>[(0,s.bF)(u,{modelValue:e.name,"onUpdate:modelValue":t=>e.name=t,autofocus:"",fluid:"",size:"small",onKeydown:t[0]||(t[0]=(0,w.jR)(e=>e.target.blur(),["enter"])),class:(0,a.C4)({"p-invalid":!r.isNameValid(e,i)})},null,8,["modelValue","onUpdate:modelValue","class"]),e.name?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(p,{key:0,severity:"error",size:"small",variant:"simple"},{default:(0,s.k6)(()=>[(0,s.eW)((0,a.v_)(l.errors.name),1)]),_:1}))]),_:1}),(0,s.bF)(c,{field:"description",header:"Descripcion",style:{width:"48%"}},{body:(0,s.k6)(({data:e})=>[(0,s.eW)((0,a.v_)(e.description),1)]),editor:(0,s.k6)(({data:e,field:i})=>[(0,s.bF)(u,{modelValue:e.description,"onUpdate:modelValue":t=>e.description=t,autofocus:"",fluid:"",size:"small",onKeydown:t[1]||(t[1]=(0,w.jR)(e=>e.target.blur(),["enter"])),class:(0,a.C4)({"p-invalid":!r.isDescriptionValid(e,i)})},null,8,["modelValue","onUpdate:modelValue","class"]),e.description?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(p,{key:0,severity:"error",size:"small",variant:"simple"},{default:(0,s.k6)(()=>[(0,s.eW)((0,a.v_)(l.errors.description),1)]),_:1}))]),_:1})]),_:1},8,["selection","value","metaKeySelection","onCellEditComplete","pt"])]),(0,s.bF)(f,{visible:l.showAdd,"onUpdate:visible":t[4]||(t[4]=e=>l.showAdd=e),modal:"",header:l.titulo,style:{width:"25rem"}},{default:(0,s.k6)(()=>[(0,s.Lk)("div",$,[(0,s.bF)(b,{initialValues:l.initialValues,resolver:r.resolver,validateOnValueUpdate:!1,validateOnBlur:!1,onSubmit:r.onFormSubmit,class:"flex flex-col gap-4 w-full sm:w-56"},{default:(0,s.k6)(e=>[(0,s.Lk)("div",J,[(0,s.bF)(u,{name:"name",type:"text",placeholder:"Nombre",fluid:""}),e.name?.invalid?((0,s.uX)(),(0,s.Wv)(p,{key:0,severity:"error",size:"small",variant:"simple"},{default:(0,s.k6)(()=>[(0,s.eW)((0,a.v_)(e.name.error.message),1)]),_:2},1024)):(0,s.Q3)("",!0)]),(0,s.Lk)("div",Y,[(0,s.bF)(u,{name:"description",type:"text",placeholder:"Descripcion",fluid:""}),e.description?.invalid?((0,s.uX)(),(0,s.Wv)(p,{key:0,severity:"error",size:"small",variant:"simple"},{default:(0,s.k6)(()=>[(0,s.eW)((0,a.v_)(e.description.error.message),1)]),_:2},1024)):(0,s.Q3)("",!0)]),(0,s.Lk)("div",Z,[(0,s.bF)(y,{type:"button",label:"Cancelar",severity:"secondary",onClick:t[3]||(t[3]=e=>l.showAdd=!1),style:{"margin-top":"20px"}}),(0,s.bF)(y,{type:"submit",label:"Guardar",style:{"margin-left":"20px"}})])]),_:1},8,["initialValues","resolver","onSubmit"])])]),_:1},8,["visible","header"])],64)}var te={props:{selectedCondominio:{type:Object,default:null}},components:{DataTable:K.A,Column:R.A,TableBar:W.A,Dialog:D.A,InputText:S.A,Button:C.A,Form:N.A,Select:T.A,Message:U.A,ConfirmPopup:z.A,Toast:B.A},data(){return{titulo:(0,E.KR)(""),confirm:(0,M.S)(),toast:(0,q.d)(),selectedItems:(0,E.KR)([]),metaKey:(0,E.KR)(!0),items:(0,E.KR)([]),showAdd:(0,E.KR)(!1),newItem:(0,E.KR)(!1),initialValues:{id:0,name:"",description:"",condominio:null},errors:{name:"",description:""}}},methods:{async refreshTable(){try{this.selectedCondominio&&(this.items=(await h.A.getTiposLoteByCondominio(this.selectedCondominio.id)).data)}catch(e){console.error("Failed to fetch LotesTypes:",e),this.toast.add({severity:"error",summary:"Error de conexion con el servidor.",life:3e3})}},async updateLoteType(){try{return(await h.A.updateTipoLote(this.initialValues)).data}catch(e){console.error("Failed to update LoteType:",e),this.toast.add({severity:"error",summary:"Error al actualizar el registro.",life:3e3})}},async createLoteType(){try{return(await h.A.createTipoLote(this.initialValues)).data}catch(e){console.error("Failed to create LoteType:",e),this.toast.add({severity:"error",summary:"Error al crear un nuevo registro.",life:3e3})}},async deleteLoteType(e){try{await h.A.deleteTipoLote(e),this.toast.add({severity:"info",summary:"Registros borrados",life:3e3}),this.selectedItems=null,await this.refreshTable()}catch(t){console.error("Failed to delete LoteType:",t),this.toast.add({severity:"error",summary:"No se puede borrar el dato, verifique que no tenga dependencias con otros datos.",life:3e3})}},addItem(){this.selectedCondominio?(this.titulo="Agregar nuevo tipo de lote",this.initialValues.id=null,this.initialValues.name="",this.initialValues.description="",this.showAdd=!0,this.newItem=!0):this.toast.add({severity:"error",summary:"Seleccione un condominio para agregar un tipo de lote.",life:3e3})},deleteItem(e){this.selectedItems&&0!==this.selectedItems.length?this.confirm.require({target:e.currentTarget,message:"Desea borrar el/los registros?",icon:"pi pi-info-circle",rejectProps:{label:"Cancelar",severity:"secondary",outlined:!0},acceptProps:{label:"Borrar",severity:"danger"},accept:()=>{for(const e of this.selectedItems)this.deleteLoteType(e.id),this.items=this.items.filter(t=>t.id!==e.id)},reject:()=>{}}):this.toast.add({severity:"error",summary:"Seleccione un elemento para borrar.",life:3e3})},resolver({values:e}){const t={};return e.name?e.name.length>40&&(t.name=[{message:"El nombre no puede tener mas de 40 caracteres."}]):t.name=[{message:"El campo nombre es requerido."}],e.description?e.description.length>60&&(t.description=[{message:"La descripcion no puede tener mas de 60 caracteres."}]):t.description=[{message:"La descripcion es requerida."}],this.initialValues.name=e.name,this.initialValues.description=e.description,{errors:t}},async onFormSubmit({valid:e}){e&&(this.showAdd=!1,this.selectedItems=[],this.newItem&&(this.initialValues.condominio=this.selectedCondominio,this.initialValues=await this.createLoteType(),this.items=[...this.items,this.initialValues],await this.refreshTable(),this.toast.add({severity:"success",summary:"Tipo de lote actualizado correctamente.",life:3e3})))},async onCellEditComplete(e){let{data:t,field:i,newValue:s,originalValue:a}=e;s?(t[i]=s,this.initialValues=t,this.initialValues.condominio=this.selectedCondominio,await this.updateLoteType(),await this.refreshTable()):s=t[i]},isNameValid(e,t){return e[t]?!(e[t].length>40)||(this.errors.name="El nombre no puede tener mas de 40 caracteres.",!1):(this.errors.name="El nombre es un campo requerido.",!1)},isDescriptionValid(e,t){return e[t]?!(e[t].length>60)||(this.errors.description="La descripcion no puede tener mas de 60 caracteres.",!1):(this.errors.description="La descripcion es un campo requerido.",!1)},exportExcel(){if(0===this.items.length)this.toast.add({severity:"warn",summary:"No hay datos para exportar.",life:3e3});else{const e=this.items.map(e=>({Nombre:e.name,Descripcion:e.description})),t=X.Wp.json_to_sheet(e),i=X.Wp.book_new();X.Wp.book_append_sheet(i,t,"Tipos de lotes");const s=X.M9(i,{bookType:"xlsx",type:"array"}),a=new Blob([s],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});(0,j.saveAs)(a,"Tipos de lotes.xlsx")}}},watch:{selectedCondominio(e,t){this.refreshTable(),this.selectedItems=null}},mounted(){this.refreshTable()}};const ie=(0,Q.A)(te,[["render",ee]]);var se=ie;const ae={style:{width:"90%"}},oe={class:"form"},le={class:"flex flex-col gap-1"},re={class:"flex flex-col gap-1"},ne={class:"flex flex-col gap-1"},de={class:"formButtons"};function me(e,t,i,o,l,r){const n=(0,s.g2)("Toast"),d=(0,s.g2)("ConfirmPopup"),m=(0,s.g2)("TableBar"),c=(0,s.g2)("Column"),u=(0,s.g2)("InputText"),p=(0,s.g2)("Message"),h=(0,s.g2)("DataTable"),y=(0,s.g2)("Button"),b=(0,s.g2)("Form"),f=(0,s.g2)("Dialog");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bF)(n),(0,s.bF)(d),(0,s.Lk)("div",ae,[(0,s.bF)(m,{showIcons:[1,0,1,1,1],onAddItem:r.addItem,onDeleteItem:r.deleteItem,onRefreshTable:r.refreshTable,onExportExcel:r.exportExcel},null,8,["onAddItem","onDeleteItem","onRefreshTable","onExportExcel"]),(0,s.bF)(h,{selection:l.selectedItems,"onUpdate:selection":t[3]||(t[3]=e=>l.selectedItems=e),value:l.items,sortField:"id",stripedRows:"",size:"small",paginator:"",rows:10,selectionMode:"multiple",metaKeySelection:l.metaKey,dataKey:"id",editMode:"cell",onCellEditComplete:r.onCellEditComplete,pt:{table:{style:"min-width: 50rem"},column:{bodycell:({state:e})=>({class:[{"!py-0":e["d_editing"]}]})}}},{empty:(0,s.k6)(()=>t[6]||(t[6]=[(0,s.eW)(" No existen datos para esta tabla. ",-1)])),loading:(0,s.k6)(()=>t[7]||(t[7]=[(0,s.eW)(" Cargando informacion.... ",-1)])),default:(0,s.k6)(()=>[(0,s.bF)(c,{selectionMode:"multiple",style:{width:"2%"}}),(0,s.bF)(c,{field:"name",header:"Nombre",style:{width:"30%"}},{body:(0,s.k6)(({data:e})=>[(0,s.eW)((0,a.v_)(e.name),1)]),editor:(0,s.k6)(({data:e,field:i})=>[(0,s.bF)(u,{modelValue:e.name,"onUpdate:modelValue":t=>e.name=t,autofocus:"",fluid:"",size:"small",onKeydown:t[0]||(t[0]=(0,w.jR)(e=>e.target.blur(),["enter"])),class:(0,a.C4)({"p-invalid":!r.isNameValid(e,i)})},null,8,["modelValue","onUpdate:modelValue","class"]),e.name?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(p,{key:0,severity:"error",size:"small",variant:"simple"},{default:(0,s.k6)(()=>[(0,s.eW)((0,a.v_)(l.errors.name),1)]),_:1}))]),_:1}),(0,s.bF)(c,{field:"amount",header:"Monto",style:{width:"30%"}},{body:(0,s.k6)(({data:e})=>[(0,s.eW)((0,a.v_)(r.formatCurrency(e.amount)),1)]),editor:(0,s.k6)(({data:e,field:i})=>[(0,s.bF)(u,{modelValue:e.amount,"onUpdate:modelValue":t=>e.amount=t,autofocus:"",fluid:"",size:"small",onKeydown:t[1]||(t[1]=(0,w.jR)(e=>e.target.blur(),["enter"])),class:(0,a.C4)({"p-invalid":!r.isAmountValid(e,i)})},null,8,["modelValue","onUpdate:modelValue","class"]),e.amount?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(p,{key:0,severity:"error",size:"small",variant:"simple"},{default:(0,s.k6)(()=>[(0,s.eW)((0,a.v_)(l.errors.amount),1)]),_:1}))]),_:1}),(0,s.bF)(c,{field:"description",header:"Descripcion",style:{width:"30%"}},{body:(0,s.k6)(({data:e})=>[(0,s.eW)((0,a.v_)(e.description),1)]),editor:(0,s.k6)(({data:e,field:i})=>[(0,s.bF)(u,{modelValue:e.description,"onUpdate:modelValue":t=>e.description=t,autofocus:"",fluid:"",size:"small",onKeydown:t[2]||(t[2]=(0,w.jR)(e=>e.target.blur(),["enter"])),class:(0,a.C4)({"p-invalid":!r.isDescriptionValid(e,i)})},null,8,["modelValue","onUpdate:modelValue","class"]),e.description?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(p,{key:0,severity:"error",size:"small",variant:"simple"},{default:(0,s.k6)(()=>[(0,s.eW)((0,a.v_)(l.errors.description),1)]),_:1}))]),_:1})]),_:1},8,["selection","value","metaKeySelection","onCellEditComplete","pt"])]),(0,s.bF)(f,{visible:l.showAdd,"onUpdate:visible":t[5]||(t[5]=e=>l.showAdd=e),modal:"",header:l.titulo,style:{width:"25rem"}},{default:(0,s.k6)(()=>[(0,s.Lk)("div",oe,[(0,s.bF)(b,{initialValues:l.initialValues,resolver:r.resolver,validateOnValueUpdate:!1,validateOnBlur:!1,onSubmit:r.onFormSubmit,class:"flex flex-col gap-4 w-full sm:w-56"},{default:(0,s.k6)(e=>[(0,s.Lk)("div",le,[(0,s.bF)(u,{name:"name",type:"text",placeholder:"Nombre",fluid:""}),e.name?.invalid?((0,s.uX)(),(0,s.Wv)(p,{key:0,severity:"error",size:"small",variant:"simple"},{default:(0,s.k6)(()=>[(0,s.eW)((0,a.v_)(e.name.error.message),1)]),_:2},1024)):(0,s.Q3)("",!0)]),(0,s.Lk)("div",re,[(0,s.bF)(u,{name:"amount",type:"number",placeholder:"Monto",fluid:""}),e.amount?.invalid?((0,s.uX)(),(0,s.Wv)(p,{key:0,severity:"error",size:"small",variant:"simple"},{default:(0,s.k6)(()=>[(0,s.eW)((0,a.v_)(e.amount.error.message),1)]),_:2},1024)):(0,s.Q3)("",!0)]),(0,s.Lk)("div",ne,[(0,s.bF)(u,{name:"description",type:"text",placeholder:"Descripcion",fluid:""}),e.description?.invalid?((0,s.uX)(),(0,s.Wv)(p,{key:0,severity:"error",size:"small",variant:"simple"},{default:(0,s.k6)(()=>[(0,s.eW)((0,a.v_)(e.description.error.message),1)]),_:2},1024)):(0,s.Q3)("",!0)]),(0,s.Lk)("div",de,[(0,s.bF)(y,{type:"button",label:"Cancelar",severity:"secondary",onClick:t[4]||(t[4]=e=>l.showAdd=!1),style:{"margin-top":"20px"}}),(0,s.bF)(y,{type:"submit",label:"Guardar",style:{"margin-left":"20px"}})])]),_:1},8,["initialValues","resolver","onSubmit"])])]),_:1},8,["visible","header"])],64)}var ce={props:{selectedCondominio:{type:Object,default:null}},components:{DataTable:K.A,Column:R.A,TableBar:W.A,Dialog:D.A,InputText:S.A,Button:C.A,Form:N.A,Select:T.A,Message:U.A,ConfirmPopup:z.A,Toast:B.A},data(){return{titulo:(0,E.KR)(""),confirm:(0,M.S)(),toast:(0,q.d)(),selectedItems:(0,E.KR)([]),metaKey:(0,E.KR)(!0),items:(0,E.KR)([]),showAdd:(0,E.KR)(!1),newItem:(0,E.KR)(!1),initialValues:{id:0,name:"",amount:0,description:""},errors:{name:"",description:"",amount:""}}},methods:{async refreshTable(){try{this.selectedCondominio&&(this.items=(await h.A.getTiposCuotaByCondominio(this.selectedCondominio.id)).data)}catch(e){console.error("Failed to fetch CuotaTypes:",e),this.toast.add({severity:"error",summary:"Error de conexion con el servidor.",life:3e3})}},async updateCuotaType(){try{return(await h.A.updateTipoCuota(this.initialValues)).data}catch(e){console.error("Failed to update CuotaTypes:",e),this.toast.add({severity:"error",summary:"Error al actualizar el registro.",life:3e3})}},async createCuotaType(){try{return(await h.A.createTipoCuota(this.initialValues)).data}catch(e){console.error("Failed to create CuotaTypes:",e),this.toast.add({severity:"error",summary:"Error al crear un nuevo registro.",life:3e3})}},async deleteCuotaType(e){try{await h.A.deleteTipoCuota(e),this.toast.add({severity:"info",summary:"Registros borrados",life:3e3}),this.selectedItems=null,await this.refreshTable()}catch(t){console.error("Failed to delete CuotaTypes:",t),this.toast.add({severity:"error",summary:"No se puede borrar el dato, verifique que no tenga dependencias con otros datos.",life:3e3})}},formatCurrency(e){return"$ "+e.toLocaleString("es-MX",{minimumFractionDigits:2,maximumFractionDigits:2})},addItem(){this.selectedCondominio?(this.titulo="Agregar nueva cuota",this.initialValues.id=null,this.initialValues.name="",this.initialValues.description="",this.initialValues.amount=0,this.showAdd=!0,this.newItem=!0):this.toast.add({severity:"error",summary:"Seleccione un condominio para agregar un tipo de cuota.",life:3e3})},deleteItem(e){this.selectedItems&&0!==this.selectedItems.length?this.confirm.require({target:e.currentTarget,message:"Desea borrar el/los registros?",icon:"pi pi-info-circle",rejectProps:{label:"Cancelar",severity:"secondary",outlined:!0},acceptProps:{label:"Borrar",severity:"danger"},accept:()=>{for(const e of this.selectedItems)this.deleteCuotaType(e.id),this.items=this.items.filter(t=>t.id!==e.id)},reject:()=>{}}):this.toast.add({severity:"error",summary:"Seleccione un elemento para borrar.",life:3e3})},resolver({values:e}){const t={};return e.name?e.name.length>40&&(t.name=[{message:"El nombre no puede tener mas de 40 caracteres."}]):t.name=[{message:"EL campo nombre es requerido."}],e.amount?e.amount<=0&&(t.amount=[{message:"El monto debe de ser mayor a cero."}]):t.amount=[{message:"El monto es requerido."}],e.description?e.description.length>60&&(t.description=[{message:"La descripcion no puede tener mas de 60 caracteres."}]):t.description=[{message:"La descripcion es requerida."}],this.initialValues.name=e.name,this.initialValues.description=e.description,this.initialValues.amount=e.amount,{errors:t}},async onFormSubmit({valid:e}){e&&(this.showAdd=!1,this.selectedItems=[],this.newItem&&(this.initialValues.condominio=this.selectedCondominio,this.initialValues=await this.createCuotaType(),this.items=[...this.items,this.initialValues],this.refreshTable(),this.toast.add({severity:"success",summary:"Tipo de cuota actualizado correctamente.",life:3e3})))},async onCellEditComplete(e){let{data:t,field:i,newValue:s,originalValue:a}=e;s?(t[i]=s,this.initialValues=t,this.initialValues.condominio=this.selectedCondominio,await this.updateCuotaType(),await this.refreshTable()):s=t[i]},isNameValid(e,t){return e[t]?!(e[t].length>40)||(this.errors.name="El nombre no puede tener mas de 40 caracteres.",!1):(this.errors.name="El nombre es un campo requerido.",!1)},isDescriptionValid(e,t){return e[t]?!(e[t].length>60)||(this.errors.description="La descripcion no puede tener mas de 60 caracteres.",!1):(this.errors.description="La descripcion es un campo requerido.",!1)},isAmountValid(e,t){return e[t]?!(e[t]<=0)||(this.errors.amount="El monto debe de ser mayor a cero.",!1):(this.errors.amount="El monto es un campo requerido.",!1)},exportExcel(){if(0===this.items.length)this.toast.add({severity:"warn",summary:"No hay datos para exportar.",life:3e3});else{const e=this.items.map(e=>({Nombre:e.name,Monto:e.amount,Descripcion:e.description})),t=X.Wp.json_to_sheet(e),i=X.Wp.book_new();X.Wp.book_append_sheet(i,t,"Cuotas");const s=X.M9(i,{bookType:"xlsx",type:"array"}),a=new Blob([s],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});(0,j.saveAs)(a,"Cuotas de lotes.xlsx")}}},watch:{selectedCondominio(e,t){this.refreshTable(),this.selectedItems=null}},mounted(){this.refreshTable()}};const ue=(0,Q.A)(ce,[["render",me]]);var pe=ue;const he={style:{width:"80%"}},ye={class:"form"},be={class:"flex flex-col gap-1"},fe={class:"flex flex-col gap-1"},ve={class:"flex flex-col gap-1"},ge={class:"flex flex-col gap-1"},Ce={class:"formButtons"};function Te(e,t,i,o,l,r){const n=(0,s.g2)("Toast"),d=(0,s.g2)("ConfirmPopup"),m=(0,s.g2)("TableBar"),c=(0,s.g2)("Column"),u=(0,s.g2)("Button"),p=(0,s.g2)("DataTable"),h=(0,s.g2)("InputText"),y=(0,s.g2)("Message"),b=(0,s.g2)("Select"),f=(0,s.g2)("Form"),v=(0,s.g2)("Dialog"),g=(0,s.gN)("tooltip");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bF)(n),(0,s.bF)(d),(0,s.Lk)("div",he,[(0,s.bF)(m,{showIcons:[1,0,1,1,1],onAddItem:r.addItem,onDeleteItem:r.deleteItem,onRefreshTable:r.refreshTable,onExportExcel:r.exportExcel},null,8,["onAddItem","onDeleteItem","onRefreshTable","onExportExcel"]),(0,s.bF)(p,{selection:l.selectedItems,"onUpdate:selection":t[0]||(t[0]=e=>l.selectedItems=e),value:l.items,sortField:"id",stripedRows:"",size:"small",paginator:"",rows:10,selectionMode:"multiple",metaKeySelection:l.metaKey,dataKey:"id"},{empty:(0,s.k6)(()=>t[3]||(t[3]=[(0,s.eW)(" No existen datos para esta tabla. ",-1)])),loading:(0,s.k6)(()=>t[4]||(t[4]=[(0,s.eW)(" Cargando informacion.... ",-1)])),default:(0,s.k6)(()=>[(0,s.bF)(c,{selectionMode:"multiple",style:{width:"5%"}}),(0,s.bF)(c,{field:"name",header:"Nombre",style:{width:"15%"}}),(0,s.bF)(c,{field:"email",header:"Correo",style:{width:"15%"}}),(0,s.bF)(c,{field:"phone",header:"Telefono",style:{width:"15%"}}),(0,s.bF)(c,{field:"adderss",header:"Direccion",style:{width:"15%"}}),(0,s.bF)(c,{field:"lotesNames",header:"Lotes Asociados",style:{width:"15%"}}),(0,s.bF)(c,{header:"Resetear Contrasena",style:{width:"15%","text-align":"center"}},{body:(0,s.k6)(({data:e})=>[(0,s.bo)((0,s.bF)(u,{icon:"pi pi-plus",variant:"text",onClick:t=>r.resetPassword(e.id)},null,8,["onClick"]),[[g,"Resetear Contrasena",void 0,{top:!0}]])]),_:1})]),_:1},8,["selection","value","metaKeySelection"])]),(0,s.bF)(v,{visible:l.showAdd,"onUpdate:visible":t[2]||(t[2]=e=>l.showAdd=e),modal:"",header:l.titulo,style:{width:"25rem"}},{default:(0,s.k6)(()=>[(0,s.Lk)("div",ye,[(0,s.bF)(f,{initialValues:l.initialValues,resolver:r.resolver,validateOnValueUpdate:!1,validateOnBlur:!1,onSubmit:r.onFormSubmit,class:"flex flex-col gap-4 w-full sm:w-56"},{default:(0,s.k6)(e=>[(0,s.Lk)("div",be,[(0,s.bF)(h,{name:"name",type:"text",placeholder:"Nombre",fluid:""}),e.name?.invalid?((0,s.uX)(),(0,s.Wv)(y,{key:0,severity:"error",size:"small",variant:"simple"},{default:(0,s.k6)(()=>[(0,s.eW)((0,a.v_)(e.name.error.message),1)]),_:2},1024)):(0,s.Q3)("",!0)]),(0,s.Lk)("div",fe,[(0,s.bF)(h,{name:"email",type:"text",placeholder:"Correo",fluid:""}),e.email?.invalid?((0,s.uX)(),(0,s.Wv)(y,{key:0,severity:"error",size:"small",variant:"simple"},{default:(0,s.k6)(()=>[(0,s.eW)((0,a.v_)(e.email.error.message),1)]),_:2},1024)):(0,s.Q3)("",!0)]),(0,s.Lk)("div",ve,[(0,s.bF)(h,{name:"phone",type:"text",placeholder:"Telefono",fluid:""}),e.phone?.invalid?((0,s.uX)(),(0,s.Wv)(y,{key:0,severity:"error",size:"small",variant:"simple"},{default:(0,s.k6)(()=>[(0,s.eW)((0,a.v_)(e.phone.error.message),1)]),_:2},1024)):(0,s.Q3)("",!0)]),(0,s.Lk)("div",ge,[(0,s.bF)(h,{name:"address",type:"text",placeholder:"Direccion",fluid:""}),e.address?.invalid?((0,s.uX)(),(0,s.Wv)(y,{key:0,severity:"error",size:"small",variant:"simple"},{default:(0,s.k6)(()=>[(0,s.eW)((0,a.v_)(e.address.error.message),1)]),_:2},1024)):(0,s.Q3)("",!0)]),(0,s.bF)(b,{name:"lote",options:l.itemsLote,optionLabel:"name",placeholder:"Lote",fluid:"",style:{"margin-bottom":"10px","margin-top":"10px"}},null,8,["options"]),e.lote?.invalid?((0,s.uX)(),(0,s.Wv)(y,{key:0,severity:"error",size:"small",variant:"simple"},{default:(0,s.k6)(()=>[(0,s.eW)((0,a.v_)(e.lote.error.message),1)]),_:2},1024)):(0,s.Q3)("",!0),(0,s.Lk)("div",Ce,[(0,s.bF)(u,{type:"button",label:"Cancelar",severity:"secondary",onClick:t[1]||(t[1]=e=>l.showAdd=!1),style:{"margin-top":"20px"}}),(0,s.bF)(u,{type:"submit",label:"Guardar",style:{"margin-left":"20px"}})])]),_:1},8,["initialValues","resolver","onSubmit"])])]),_:1},8,["visible","header"])],64)}var we={props:{selectedCondominio:{type:Object,default:null}},components:{DataTable:K.A,Column:R.A,TableBar:W.A,Dialog:D.A,InputText:S.A,Button:C.A,Form:N.A,Select:T.A,Message:U.A,ConfirmPopup:z.A,Toast:B.A},data(){return{titulo:(0,E.KR)(""),confirm:(0,M.S)(),toast:(0,q.d)(),selectedItems:(0,E.KR)([]),metaKey:(0,E.KR)(!0),items:(0,E.KR)([]),itemsLote:(0,E.KR)([]),showAdd:(0,E.KR)(!1),newItem:(0,E.KR)(!1),initialValues:{id:0,name:"",email:"",phone:"",address:"",lote:null}}},methods:{async refreshTable(){try{this.selectedCondominio&&(this.items=(await h.A.getUsuariosByCondominio(this.selectedCondominio.id)).data)}catch(e){console.error("Failed to fetch Usuarios:",e),this.toast.add({severity:"error",summary:"Error de conexion con el servidor.",life:3e3})}},async getLotes(){try{this.itemsLote=(await h.A.getLotesByCondominio(this.selectedCondominio.id)).data}catch(e){console.error("Failed to fetch Lotes:",e),this.toast.add({severity:"error",summary:"Error de conexion con el servidor.",life:3e3})}},async updateUsuario(){try{return(await h.A.updateUsuario(this.initialValues)).data}catch(e){console.error("Failed to update Usuario:",e),this.toast.add({severity:"error",summary:"Error de conexion con el servidor.",life:3e3})}},async createUsuario(){try{return(await h.A.createUsuario(this.initialValues)).data}catch(e){console.error("Failed to create Usuario:",e),this.toast.add({severity:"error",summary:"Error de conexion con el servidor.",life:3e3})}},async deleteUsuario(e){try{await h.A.deleteUsuario(e),this.toast.add({severity:"info",summary:"Registros borrados",life:3e3}),this.selectedItems=null,await this.refreshTable()}catch(t){console.error("Failed to delete Usuario:",t),this.toast.add({severity:"error",summary:"No se puede borrar el dato, verifique que no tenga dependencias con otros datos.",life:3e3})}},resetPassword(e){console.log("reste passsword id usuario "+e)},addItem(){this.selectedCondominio?(this.titulo="Agregar nuevo usuario",this.getLotes(),this.initialValues.id=null,this.initialValues.name="",this.initialValues.email="",this.initialValues.phone="",this.initialValues.address="",this.initialValues.lote=null,this.showAdd=!0,this.newItem=!0):this.toast.add({severity:"error",summary:"Seleccione un condominio para agregar un usuario.",life:3e3})},deleteItem(e){this.selectedItems&&0!==this.selectedItems.length?this.confirm.require({target:e.currentTarget,message:"Desea borrar el/los registros?",icon:"pi pi-info-circle",rejectProps:{label:"Cancelar",severity:"secondary",outlined:!0},acceptProps:{label:"Borrar",severity:"danger"},accept:()=>{for(const e of this.selectedItems)this.deleteUsuario(e.id),this.items=this.items.filter(t=>t.id!==e.id)},reject:()=>{}}):this.toast.add({severity:"error",summary:"Seleccione un elemento para borrar.",life:3e3})},resolver({values:e}){const t={};return e.name?e.name.length>40&&(t.name=[{message:"El nombre no puede tener mas de 40 caracteres."}]):t.name=[{message:"El nombre es requerido."}],e.email?e.email.length>60&&(t.email=[{message:"El email no puede tener mas de 60 caracteres."}]):t.email=[{message:"El email es requerido."}],10!=e.phone.length&&(t.phone=[{message:"El telefono debe de sr de 10 digitos."}]),100!=e.address.length&&(t.address=[{message:"La direccion no puede ser mayor a 100 caracteres."}]),e.lote||(t.lote=[{message:"El lote es requerido."}]),this.initialValues.name=e.name,this.initialValues.email=e.email,this.initialValues.phone=e.phone,this.initialValues.address=e.address,this.initialValues.lote=e.lote,{errors:t}},async onFormSubmit({valid:e}){e&&(this.showAdd=!1,this.selectedItems=[],this.newItem&&(this.initialValues=await this.createUsuario(),this.items=[...this.items,this.initialValues],this.refreshTable(),this.toast.add({severity:"success",summary:"Contacto actualizado correctamente.",life:3e3})))},async onCellEditComplete(e){let{data:t,field:i,newValue:s,originalValue:a}=e;s?(t[i]=s,this.initialValues=t,this.initialValues.condominio=this.selectedCondominio,await this.updateUsuario(),await this.refreshTable()):s=t[i]},isNameValid(e,t){return e[t]?!(e[t].length>40)||(this.errors.name="El nombre no puede tener mas de 40 caracteres.",!1):(this.errors.name="El nombre es un campo requerido.",!1)},isDescriptionValid(e,t){return e[t]?!(e[t].length>60)||(this.errors.description="La descripcion no puede tener mas de 60 caracteres.",!1):(this.errors.description="La descripcion es un campo requerido.",!1)},exportExcel(){if(0===this.items.length)this.toast.add({severity:"warn",summary:"No hay datos para exportar.",life:3e3});else{const e=this.items.map(e=>({Nombre:e.name,Email:e.email,Telefono:e.phone,Direccion:e.adderss,Lote:e.lote})),t=X.Wp.json_to_sheet(e),i=X.Wp.book_new();X.Wp.book_append_sheet(i,t,"usuarios");const s=X.M9(i,{bookType:"xlsx",type:"array"}),a=new Blob([s],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});(0,j.saveAs)(a,"Listado de usuarios.xlsx")}}},watch:{selectedCondominio(e,t){this.refreshTable(),this.selectedItems=null}},mounted(){this.refreshTable()}};const Ve=(0,Q.A)(we,[["render",Te]]);var ke=Ve;const Ae={style:{width:"70%"}},xe={style:{width:"100%"}},Fe={style:{width:"100%"}},Ie={class:"form"},Le={class:"flex flex-col gap-1"},_e={class:"flex flex-col gap-1"},Ee={class:"formButtons"};function We(e,t,i,o,l,r){const n=(0,s.g2)("Toast"),d=(0,s.g2)("ConfirmPopup"),m=(0,s.g2)("TableBar"),c=(0,s.g2)("Column"),u=(0,s.g2)("InputText"),p=(0,s.g2)("Message"),h=(0,s.g2)("DataTable"),y=(0,s.g2)("Button"),b=(0,s.g2)("Form"),f=(0,s.g2)("Dialog");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bF)(n),(0,s.bF)(d),(0,s.Lk)("div",Ae,[(0,s.Lk)("div",xe,[t[10]||(t[10]=(0,s.Lk)("b",null,"Conceptos para cargos",-1)),(0,s.bF)(m,{showIcons:[1,0,1,1,1],onAddItem:r.addItemC,onDeleteItem:r.deleteItemC,onRefreshTable:r.refreshTables,onExportExcel:r.exportExcel},null,8,["onAddItem","onDeleteItem","onRefreshTable","onExportExcel"]),(0,s.bF)(h,{selection:l.selectedItemsC,"onUpdate:selection":t[2]||(t[2]=e=>l.selectedItemsC=e),value:l.itemsC,sortField:"id",stripedRows:"",size:"small",columnResizeMode:"expand",paginator:"",rows:10,selectionMode:"multiple",metaKeySelection:l.metaKeyC,dataKey:"id",editMode:"cell",onCellEditComplete:r.onCellEditCompleteC,pt:{table:{style:"min-width: 50rem"},column:{bodycell:({state:e})=>({class:[{"!py-0":e["d_editing"]}]})}}},{empty:(0,s.k6)(()=>t[8]||(t[8]=[(0,s.eW)(" No existen datos para esta tabla. ",-1)])),loading:(0,s.k6)(()=>t[9]||(t[9]=[(0,s.eW)(" Cargando informacion.... ",-1)])),default:(0,s.k6)(()=>[(0,s.bF)(c,{selectionMode:"multiple",headerStyle:"width: 2%"}),(0,s.bF)(c,{field:"name",header:"Nombre",headerStyle:"width: 48%"},{body:(0,s.k6)(({data:e})=>[(0,s.eW)((0,a.v_)(e.name),1)]),editor:(0,s.k6)(({data:e,field:i})=>[(0,s.bF)(u,{modelValue:e.name,"onUpdate:modelValue":t=>e.name=t,autofocus:"",fluid:"",size:"small",onKeydown:t[0]||(t[0]=(0,w.jR)(e=>e.target.blur(),["enter"])),class:(0,a.C4)({"p-invalid":!r.isNameValid(e,i)})},null,8,["modelValue","onUpdate:modelValue","class"]),r.isNameValid(e,i)?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(p,{key:0,severity:"error",size:"small",variant:"simple"},{default:(0,s.k6)(()=>[(0,s.eW)((0,a.v_)(l.errors.name),1)]),_:1}))]),_:1}),(0,s.bF)(c,{field:"description",header:"Descripcion",headerStyle:"width: 50%"},{body:(0,s.k6)(({data:e})=>[(0,s.eW)((0,a.v_)(e.description),1)]),editor:(0,s.k6)(({data:e,field:i})=>[(0,s.bF)(u,{modelValue:e.description,"onUpdate:modelValue":t=>e.description=t,autofocus:"",fluid:"",size:"small",onKeydown:t[1]||(t[1]=(0,w.jR)(e=>e.target.blur(),["enter"])),class:(0,a.C4)({"p-invalid":!r.isDescriptionValid(e,i)})},null,8,["modelValue","onUpdate:modelValue","class"]),r.isDescriptionValid(e,i)?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(p,{key:0,severity:"error",size:"small",variant:"simple"},{default:(0,s.k6)(()=>[(0,s.eW)((0,a.v_)(l.errors.description),1)]),_:1}))]),_:1})]),_:1},8,["selection","value","metaKeySelection","onCellEditComplete","pt"])]),t[14]||(t[14]=(0,s.Lk)("br",null,null,-1)),t[15]||(t[15]=(0,s.Lk)("hr",null,null,-1)),(0,s.Lk)("div",Fe,[t[13]||(t[13]=(0,s.Lk)("b",null,"Conceptos para abonos",-1)),(0,s.bF)(m,{showIcons:[1,0,1,0,0],onAddItem:r.addItemA,onDeleteItem:r.deleteItemA},null,8,["onAddItem","onDeleteItem"]),(0,s.bF)(h,{selection:l.selectedItemsA,"onUpdate:selection":t[5]||(t[5]=e=>l.selectedItemsA=e),value:l.itemsA,sortField:"id",stripedRows:"",size:"small",paginator:"",rows:10,selectionMode:"multiple",metaKeySelection:l.metaKeyA,dataKey:"id",editMode:"cell",onCellEditComplete:r.onCellEditCompleteA,pt:{table:{style:"min-width: 50rem"},column:{bodycell:({state:e})=>({class:[{"!py-0":e["d_editing"]}]})}}},{empty:(0,s.k6)(()=>t[11]||(t[11]=[(0,s.eW)(" No existen datos para esta tabla. ",-1)])),loading:(0,s.k6)(()=>t[12]||(t[12]=[(0,s.eW)(" Cargando informacion.... ",-1)])),default:(0,s.k6)(()=>[(0,s.bF)(c,{selectionMode:"multiple",style:{width:"2%"}}),(0,s.bF)(c,{field:"name",header:"Nombre",style:{width:"30%"}},{body:(0,s.k6)(({data:e})=>[(0,s.eW)((0,a.v_)(e.name),1)]),editor:(0,s.k6)(({data:e,field:i})=>[(0,s.bF)(u,{modelValue:e.name,"onUpdate:modelValue":t=>e.name=t,autofocus:"",fluid:"",size:"small",onKeydown:t[3]||(t[3]=(0,w.jR)(e=>e.target.blur(),["enter"])),class:(0,a.C4)({"p-invalid":!r.isNameValid(e,i)})},null,8,["modelValue","onUpdate:modelValue","class"]),r.isNameValid(e,i)?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(p,{key:0,severity:"error",size:"small",variant:"simple"},{default:(0,s.k6)(()=>[(0,s.eW)((0,a.v_)(l.errors.name),1)]),_:1}))]),_:1}),(0,s.bF)(c,{field:"description",header:"Descripcion",style:{width:"30%"}},{body:(0,s.k6)(({data:e})=>[(0,s.eW)((0,a.v_)(e.description),1)]),editor:(0,s.k6)(({data:e,field:i})=>[(0,s.bF)(u,{modelValue:e.description,"onUpdate:modelValue":t=>e.description=t,autofocus:"",fluid:"",size:"small",onKeydown:t[4]||(t[4]=(0,w.jR)(e=>e.target.blur(),["enter"])),class:(0,a.C4)({"p-invalid":!r.isDescriptionValid(e,i)})},null,8,["modelValue","onUpdate:modelValue","class"]),r.isDescriptionValid(e,i)?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(p,{key:0,severity:"error",size:"small",variant:"simple"},{default:(0,s.k6)(()=>[(0,s.eW)((0,a.v_)(l.errors.description),1)]),_:1}))]),_:1})]),_:1},8,["selection","value","metaKeySelection","onCellEditComplete","pt"])])]),(0,s.bF)(f,{visible:l.showAdd,"onUpdate:visible":t[7]||(t[7]=e=>l.showAdd=e),modal:"",header:l.titulo,style:{width:"25rem"}},{default:(0,s.k6)(()=>[(0,s.Lk)("div",Ie,[(0,s.bF)(b,{initialValues:l.initialValues,resolver:r.resolver,validateOnValueUpdate:!1,validateOnBlur:!1,onSubmit:r.onFormSubmit,class:"flex flex-col gap-4 w-full sm:w-56"},{default:(0,s.k6)(e=>[(0,s.Lk)("div",Le,[(0,s.bF)(u,{name:"name",type:"text",placeholder:"Nombre",fluid:""}),e.name?.invalid?((0,s.uX)(),(0,s.Wv)(p,{key:0,severity:"error",size:"small",variant:"simple"},{default:(0,s.k6)(()=>[(0,s.eW)((0,a.v_)(e.name.error.message),1)]),_:2},1024)):(0,s.Q3)("",!0)]),(0,s.Lk)("div",_e,[(0,s.bF)(u,{name:"description",type:"text",placeholder:"Descripcion",fluid:""}),e.description?.invalid?((0,s.uX)(),(0,s.Wv)(p,{key:0,severity:"error",size:"small",variant:"simple"},{default:(0,s.k6)(()=>[(0,s.eW)((0,a.v_)(e.description.error.message),1)]),_:2},1024)):(0,s.Q3)("",!0)]),(0,s.Lk)("div",Ee,[(0,s.bF)(y,{type:"button",label:"Cancelar",severity:"secondary",onClick:t[6]||(t[6]=e=>l.showAdd=!1),style:{"margin-top":"20px"}}),(0,s.bF)(y,{type:"submit",label:"Guardar",style:{"margin-left":"20px"}})])]),_:1},8,["initialValues","resolver","onSubmit"])])]),_:1},8,["visible","header"])],64)}var Ke={props:{selectedCondominio:{type:Object,default:null}},components:{DataTable:K.A,Column:R.A,TableBar:W.A,Dialog:D.A,InputText:S.A,Button:C.A,Form:N.A,Select:T.A,Message:U.A,ConfirmPopup:z.A,Toast:B.A},data(){return{titulo:(0,E.KR)(""),confirm:(0,M.S)(),toast:(0,q.d)(),itemsC:(0,E.KR)([]),itemsA:(0,E.KR)([]),metaKeyC:(0,E.KR)(!0),metaKeyA:(0,E.KR)(!0),selectedItemsC:(0,E.KR)([]),selectedItemsA:(0,E.KR)([]),showAdd:(0,E.KR)(!1),newItem:(0,E.KR)(!1),isC:null,initialValues:{id:0,name:"",description:"",tipo:""},errors:{name:"",description:""}}},methods:{async refreshTables(){await this.refreshTableC(),await this.refreshTableA()},async refreshTableC(){try{this.selectedCondominio&&(this.itemsC=(await h.A.getTransaccionesLoteTypesByCondominio(this.selectedCondominio.id,2)).data)}catch(e){console.error("Failed to fetch CuotaTypes:",e),this.toast.add({severity:"error",summary:"Error de conexion con el servidor.",life:3e3})}},async refreshTableA(){try{this.selectedCondominio&&(this.itemsA=(await h.A.getTransaccionesLoteTypesByCondominio(this.selectedCondominio.id,1)).data)}catch(e){console.error("Failed to fetch CuotaTypes:",e),this.toast.add({severity:"error",summary:"Error de conexion con el servidor.",life:3e3})}},async updateTransaccionesLoteTypes(){try{return(await h.A.updateTransaccionesLoteTypes(this.initialValues)).data}catch(e){console.error("Failed to update CuotaTypes:",e),this.toast.add({severity:"error",summary:"Error al actualizar el registro.",life:3e3})}},async createTransaccionesLoteTypes(){try{return(await h.A.createTransaccionesLoteTypes(this.initialValues)).data}catch(e){console.error("Failed to create CuotaTypes:",e),this.toast.add({severity:"error",summary:"Error al crear un nuevo registro.",life:3e3})}},async deleteTransaccionesLoteTypes(e){try{await h.A.deleteTransaccionesLoteTypes(e),this.toast.add({severity:"info",summary:"Registros borrados",life:3e3}),this.selectedItems=null,await this.refreshTable()}catch(t){console.error("Failed to delete CuotaTypes:",t),this.toast.add({severity:"error",summary:"No se puede borrar el dato, verifique que no tenga dependencias con otros datos.",life:3e3})}},formatCurrency(e){return"$ "+e.toLocaleString("es-MX",{minimumFractionDigits:2,maximumFractionDigits:2})},addItemC(){this.selectedCondominio?(this.titulo="Agregar nuevo tipo de cargo",this.initialValues.id=null,this.initialValues.name="",this.initialValues.description="",this.showAdd=!0,this.newItem=!0,this.isC=!0):this.toast.add({severity:"error",summary:"Seleccione un condominio para agregar un concepto.",life:3e3})},deleteItemC(e){this.selectedItemsC&&0!==this.selectedItemsC.length?this.confirm.require({target:e.currentTarget,message:"Desea borrar el/los registros?",icon:"pi pi-info-circle",rejectProps:{label:"Cancelar",severity:"secondary",outlined:!0},acceptProps:{label:"Borrar",severity:"danger"},accept:()=>{for(const e of this.selectedItemsC)this.deleteTransaccionesLoteTypes(e.id),this.itemsC=this.itemsC.filter(t=>t.id!==e.id)},reject:()=>{}}):this.toast.add({severity:"error",summary:"Seleccione un elemento para borrar.",life:3e3})},resolver({values:e}){const t={};return e.name?e.name.length>40&&(t.name=[{message:"El nombre no puede tener mas de 40 caracteres."}]):t.name=[{message:"EL campo nombre es requerido."}],e.description?e.description.length>60&&(t.description=[{message:"La descripcion no puede tener mas de 60 caracteres."}]):t.description=[{message:"La descripcion es requerida."}],this.initialValues.name=e.name,this.initialValues.description=e.description,{errors:t}},async onFormSubmit({valid:e}){e&&(this.showAdd=!1,this.selectedItems=[],this.newItem&&(this.initialValues.condominio=this.selectedCondominio,this.isC?this.initialValues.tipo="CARGO":this.initialValues.tipo="ABONO",this.initialValues=await this.createTransaccionesLoteTypes(),this.refreshTables(),this.toast.add({severity:"success",summary:"Tipo de cargo / abono agregado correctamente.",life:3e3})))},isNameValid(e,t){return e[t]?!(e[t].length>40)||(this.errors.name="El nombre no puede tener mas de 40 caracteres.",!1):(this.errors.name="El nombre es un campo requerido.",!1)},isDescriptionValid(e,t){return e[t]?!(e[t].length>60)||(this.errors.description="La descripcion no puede tener mas de 60 caracteres.",!1):(this.errors.description="La descripcion es un campo requerido.",!1)},async onCellEditCompleteC(e){let{data:t,field:i,newValue:s,originalValue:a}=e;s?(t[i]=s,this.initialValues=t,this.initialValues.condominio=this.selectedCondominio,await this.updateTransaccionesLoteTypes(),await this.refreshTables()):s=t[i]},exportExcel(){if(0===this.itemsC.length&&0===this.itemsA.length)this.toast.add({severity:"warn",summary:"No hay datos para exportar.",life:3e3});else{let e=this.itemsC.map(e=>({Nombre:e.name,"Cargo/Abono":"Cargo",Descripcion:e.description})),t=this.itemsA.map(e=>({Nombre:e.name,"Cargo/Abono":"Abono",Descripcion:e.description}));const i=[...e,...t],s=X.Wp.json_to_sheet(i),a=X.Wp.book_new();X.Wp.book_append_sheet(a,s,"Cargos_Abonos");const o=X.M9(a,{bookType:"xlsx",type:"array"}),l=new Blob([o],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});(0,j.saveAs)(l,"Tipos de Cargos-Abonos.xlsx")}},addItemA(){this.selectedCondominio?(this.titulo="Agregar nuevo tipo de abono",this.initialValues.id=null,this.initialValues.name="",this.initialValues.description="",this.showAdd=!0,this.newItem=!0,this.isC=!1):this.toast.add({severity:"error",summary:"Seleccione un condominio para agregar un concepto.",life:3e3})},deleteItemA(e){this.selectedItemsA&&0!==this.selectedItemsA.length?this.confirm.require({target:e.currentTarget,message:"Desea borrar el/los registros?",icon:"pi pi-info-circle",rejectProps:{label:"Cancelar",severity:"secondary",outlined:!0},acceptProps:{label:"Borrar",severity:"danger"},accept:()=>{for(const e of this.selectedItemsA)this.deleteTransaccionesLoteTypes(e.id),this.itemsA=this.itemsA.filter(t=>t.id!==e.id)},reject:()=>{}}):this.toast.add({severity:"error",summary:"Seleccione un elemento para borrar.",life:3e3})},async onCellEditCompleteA(e){let{data:t,field:i,newValue:s,originalValue:a}=e;s?(t[i]=s,this.initialValues=t,this.initialValues.condominio=this.selectedCondominio,await this.updateTransaccionesLoteTypes(),await this.refreshTables()):s=t[i]}},watch:{selectedCondominio(e,t){this.refreshTables(),this.selectedItemsC=null,this.selectedItemsA=null}},mounted(){this.refreshTables()}};const Re=(0,Q.A)(Ke,[["render",We]]);var De=Re;const Se={style:{width:"90%"}},Ue={class:"form"},ze={class:"flex flex-col gap-1"},Be={class:"flex flex-col gap-1"},Ne={class:"formButtons"};function qe(e,t,i,o,l,r){const n=(0,s.g2)("Toast"),d=(0,s.g2)("ConfirmPopup"),m=(0,s.g2)("TableBar"),c=(0,s.g2)("Column"),u=(0,s.g2)("Select"),p=(0,s.g2)("InputText"),h=(0,s.g2)("Message"),y=(0,s.g2)("DataTable"),b=(0,s.g2)("Button"),f=(0,s.g2)("Form"),v=(0,s.g2)("Dialog");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bF)(n),(0,s.bF)(d),(0,s.Lk)("div",Se,[(0,s.bF)(m,{showIcons:[1,0,1,1,1],onAddItem:r.addItem,onDeleteItem:r.deleteItem,onRefreshTable:r.refreshTable,onExportExcel:r.exportExcel},null,8,["onAddItem","onDeleteItem","onRefreshTable","onExportExcel"]),(0,s.bF)(y,{selection:l.selectedItems,"onUpdate:selection":t[2]||(t[2]=e=>l.selectedItems=e),value:l.items,sortField:"tipo",stripedRows:"",size:"small",paginator:"",rows:10,selectionMode:"multiple",metaKeySelection:l.metaKey,dataKey:"id",editMode:"cell",sortOrder:1,onCellEditComplete:r.onCellEditComplete,pt:{table:{style:"min-width: 50rem"},column:{bodycell:({state:e})=>({class:[{"!py-0":e["d_editing"]}]})}}},{empty:(0,s.k6)(()=>t[5]||(t[5]=[(0,s.eW)(" No existen datos para esta tabla. ",-1)])),loading:(0,s.k6)(()=>t[6]||(t[6]=[(0,s.eW)(" Cargando informacion.... ",-1)])),default:(0,s.k6)(()=>[(0,s.bF)(c,{selectionMode:"multiple",style:{width:"2%"}}),(0,s.bF)(c,{field:"tipo",header:"Tipo",style:{width:"48%"}},{body:(0,s.k6)(({data:e})=>[(0,s.eW)((0,a.v_)(e.tipo),1)]),editor:(0,s.k6)(({data:e})=>[(0,s.bF)(u,{name:"tipos",options:l.tipos,modelValue:l.selectedType,"onUpdate:modelValue":t[0]||(t[0]=e=>l.selectedType=e),optionLabel:"value",placeholder:"Tipo de lote",fluid:"",style:{"margin-bottom":"10px","margin-top":"10px"},size:"small"},null,8,["options","modelValue"])]),_:1}),(0,s.bF)(c,{field:"name",header:"Nombre",style:{width:"48%"}},{body:(0,s.k6)(({data:e})=>[(0,s.eW)((0,a.v_)(e.name),1)]),editor:(0,s.k6)(({data:e,field:i})=>[(0,s.bF)(p,{modelValue:e.name,"onUpdate:modelValue":t=>e.name=t,autofocus:"",fluid:"",size:"small",onKeydown:t[1]||(t[1]=(0,w.jR)(e=>e.target.blur(),["enter"])),class:(0,a.C4)({"p-invalid":!r.isNameValid(e,i)})},null,8,["modelValue","onUpdate:modelValue","class"]),e.name?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(h,{key:0,severity:"error",size:"small",variant:"simple"},{default:(0,s.k6)(()=>[(0,s.eW)((0,a.v_)(l.errors.name),1)]),_:1}))]),_:1})]),_:1},8,["selection","value","metaKeySelection","onCellEditComplete","pt"])]),(0,s.bF)(v,{visible:l.showAdd,"onUpdate:visible":t[4]||(t[4]=e=>l.showAdd=e),modal:"",header:l.titulo,style:{width:"25rem"}},{default:(0,s.k6)(()=>[(0,s.Lk)("div",Ue,[(0,s.bF)(f,{initialValues:l.initialValues,resolver:r.resolver,validateOnValueUpdate:!1,validateOnBlur:!1,onSubmit:r.onFormSubmit,class:"flex flex-col gap-4 w-full sm:w-56"},{default:(0,s.k6)(e=>[(0,s.Lk)("div",ze,[(0,s.bF)(u,{name:"tipo",options:l.tipos,placeholder:"Tipo",optionLabel:"value",fluid:""},null,8,["options"]),e.tipo?.invalid?((0,s.uX)(),(0,s.Wv)(h,{key:0,severity:"error",size:"small",variant:"simple"},{default:(0,s.k6)(()=>[(0,s.eW)((0,a.v_)(e.tipo.error.message),1)]),_:2},1024)):(0,s.Q3)("",!0)]),(0,s.Lk)("div",Be,[(0,s.bF)(p,{name:"name",type:"text",placeholder:"Nombre",fluid:""}),e.name?.invalid?((0,s.uX)(),(0,s.Wv)(h,{key:0,severity:"error",size:"small",variant:"simple"},{default:(0,s.k6)(()=>[(0,s.eW)((0,a.v_)(e.name.error.message),1)]),_:2},1024)):(0,s.Q3)("",!0)]),(0,s.Lk)("div",Ne,[(0,s.bF)(b,{type:"button",label:"Cancelar",severity:"secondary",onClick:t[3]||(t[3]=e=>l.showAdd=!1),style:{"margin-top":"20px"}}),(0,s.bF)(b,{type:"submit",label:"Guardar",style:{"margin-left":"20px"}})])]),_:1},8,["initialValues","resolver","onSubmit"])])]),_:1},8,["visible","header"])],64)}var Me={props:{selectedCondominio:{type:Object,default:null}},components:{DataTable:K.A,Column:R.A,TableBar:W.A,Dialog:D.A,InputText:S.A,Button:C.A,Form:N.A,Select:T.A,Message:U.A,ConfirmPopup:z.A,Toast:B.A},data(){return{titulo:(0,E.KR)(""),confirm:(0,M.S)(),toast:(0,q.d)(),selectedItems:(0,E.KR)([]),selectedType:(0,E.KR)(),metaKey:(0,E.KR)(!0),items:(0,E.KR)([]),showAdd:(0,E.KR)(!1),newItem:(0,E.KR)(!1),initialValues:{id:0,tipo:"",name:"",condominio:null},errors:{name:"",tipo:""},tipos:[{id:"GASTOS_FIJOS",value:"Gastos Fijos"},{id:"GASTOS_VARIABLES",value:"Gastos Variables"},{id:"OTROS",value:"Otros"}]}},methods:{async refreshTable(){try{this.selectedCondominio&&(this.items=(await h.A.getTiposEgresosByCondominio(this.selectedCondominio.id)).data)}catch(e){console.error("Failed to fetch EgresoTypes:",e),this.toast.add({severity:"error",summary:"Error de conexion con el servidor.",life:3e3})}},async updateEgresoType(){try{return(await h.A.updateTipoEgreso(this.initialValues)).data}catch(e){console.error("Failed to update EgresoType:",e),this.toast.add({severity:"error",summary:"Error al actualizar el registro.",life:3e3})}},async createEgresoType(){try{return(await h.A.createTipoEgreso(this.initialValues)).data}catch(e){console.error("Failed to create EgresoType:",e),this.toast.add({severity:"error",summary:"Error al crear un nuevo registro.",life:3e3})}},async deleteEgresoType(e){try{await h.A.deleteTipoEgreso(e),this.toast.add({severity:"info",summary:"Registros borrados",life:3e3}),this.selectedItems=null,await this.refreshTable()}catch(t){console.error("Failed to delete EgresoType:",t),this.toast.add({severity:"error",summary:"No se puede borrar el dato, verifique que no tenga dependencias con otros datos.",life:3e3})}},addItem(){this.selectedCondominio?(this.titulo="Agregar nuevo tipo",this.initialValues.id=null,this.initialValues.tipo="",this.initialValues.name="",this.selectedType=null,this.showAdd=!0,this.newItem=!0):this.toast.add({severity:"error",summary:"Seleccione un condominio para agregar un tipo de egreso.",life:3e3})},deleteItem(e){this.selectedItems&&0!==this.selectedItems.length?this.confirm.require({target:e.currentTarget,message:"Desea borrar el/los registros?",icon:"pi pi-info-circle",rejectProps:{label:"Cancelar",severity:"secondary",outlined:!0},acceptProps:{label:"Borrar",severity:"danger"},accept:()=>{for(const e of this.selectedItems)this.deleteEgresoType(e.id),this.items=this.items.filter(t=>t.id!==e.id)},reject:()=>{}}):this.toast.add({severity:"error",summary:"Seleccione un elemento para borrar.",life:3e3})},resolver({values:e}){const t={};return e.name?e.name.length>40&&(t.name=[{message:"El nombre no puede tener mas de 40 caracteres."}]):t.name=[{message:"El campo nombre es requerido."}],e.tipo||(t.tipo=[{message:"El campo tipo es requerido."}]),this.initialValues.name=e.name,this.initialValues.tipo=e.tipo.id,{errors:t}},async onFormSubmit({valid:e}){e&&(this.showAdd=!1,this.selectedItems=[],this.newItem&&(this.initialValues.condominio=this.selectedCondominio,this.initialValues=await this.createEgresoType(),this.items=[...this.items,this.initialValues],await this.refreshTable(),this.toast.add({severity:"success",summary:"Tipo de egreso actualizado correctamente.",life:3e3})))},async onCellEditComplete(e){let{data:t,field:i,newValue:s,originalValue:a}=e;s?(console.log("que pasa ? "+JSON.stringify(this.selectedType)),"tipo"==i&&this.selectedType&&this.selectedType.id?t.tipo=this.selectedType.id:t[i]=s,this.initialValues=t,this.initialValues.condominio=this.selectedCondominio,await this.updateEgresoType(),await this.refreshTable()):s=t[i]},isNameValid(e,t){return e[t]?!(e[t].length>40)||(this.errors.name="El nombre no puede tener mas de 40 caracteres.",!1):(this.errors.name="El nombre es un campo requerido.",!1)},exportExcel(){if(0===this.items.length)this.toast.add({severity:"warn",summary:"No hay datos para exportar.",life:3e3});else{const e=this.items.map(e=>({Tipo:e.tipo,Nombre:e.name})),t=X.Wp.json_to_sheet(e),i=X.Wp.book_new();X.Wp.book_append_sheet(i,t,"Tipos de egresos");const s=X.M9(i,{bookType:"xlsx",type:"array"}),a=new Blob([s],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});(0,j.saveAs)(a,"Tipos de egresos.xlsx")}}},watch:{selectedCondominio(e,t){this.refreshTable(),this.selectedItems=null}},mounted(){this.refreshTable()}};const Xe=(0,Q.A)(Me,[["render",qe]]);var je=Xe,Pe={components:{Tabs:y.A,TabList:b.A,Tab:f.A,TabPanels:v.A,TabPanel:g.A,Button:C.A,Select:T.A,Lotes:G,TipoLotes:se,TipoCuotas:pe,Users:ke,ConceptosCA:De,TipoEgresos:je},data(){return{authStore:(0,p.n)(),selectedItem:null,condominiosList:[],userData:null,items:[{id:"0",label:"Lotes",icon:"pi pi-home"},{id:"1",label:"Tipo de Lotes",icon:"pi pi-tags"},{id:"2",label:"Cuotas",icon:"pi pi-dollar"},{id:"3",label:"Tipo de Cargos / Abonos",icon:"pi pi-dollar"},{id:"4",label:"Tipo de Egresos",icon:"pi pi-money-bill"},{id:"5",label:"Usuarios",icon:"pi pi-address-book"}]}},methods:{async refreshTable(){if(this.userData)try{this.condominiosList=(await h.A.getCondominiosByUsr(this.userData.id)).data}catch(e){console.error("Failed to fetch getCondominiosByUsr:",e),this.toast.add({severity:"error",summary:"Error de conexion con el servidor.",life:3e3})}},async getUserData(){try{this.userData=this.authStore.getUserData()}catch(e){console.error("Failed to fetch getUserData:",e),this.toast.add({severity:"error",summary:"Error de conexion con el servidor.",life:3e3})}}},mounted(){this.getUserData(),this.refreshTable()}};const Qe=(0,Q.A)(Pe,[["render",u]]);var Oe=Qe}}]);
//# sourceMappingURL=289.2d16f300.js.map